<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webhookmessages - Send messages through webhooks!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <!-- Main Container -->
    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md">
        <h1 class="text-3xl font-bold mb-6 text-center text-gray-800">Send a Message</h1>
        
        <!-- Webhook URL Input -->
        <div class="mb-4">
            <label for="urlInput" class="block text-sm font-medium text-gray-700 mb-2">Webhook URL:</label>
            <input type="url" id="urlInput" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-300" placeholder="Enter your webhook URL here...">
        </div>

        <!-- Message Input -->
        <div class="mb-4">
            <label for="messageInput" class="block text-sm font-medium text-gray-700 mb-2">Your Message:</label>
            <textarea id="messageInput" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-300" placeholder="Type your message here..."></textarea>
        </div>

        <!-- Image Upload Input -->
        <div class="mb-4">
            <label for="imageInput" class="block text-sm font-medium text-gray-700 mb-2">Image (Optional):</label>
            <input type="file" id="imageInput" accept="image/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-300">
        </div>

        <!-- Warning and Agreement Checkbox -->
        <div class="mb-6 flex items-start">
            <input type="checkbox" id="agreeCheckbox" class="mt-1 mr-2 rounded text-indigo-600 focus:ring-indigo-500">
            <label for="agreeCheckbox" class="text-sm font-medium text-red-600">
                <span class="font-bold">WARNING:</span> Only use this if you have permission to send messages to the provided URL.
            </label>
        </div>

        <!-- Send Button -->
        <button id="sendButton" class="w-full bg-indigo-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
            Send Message
        </button>

        <!-- Status Message -->
        <div id="statusMessage" class="mt-4 text-center text-sm font-medium"></div>

    </div>

    <script>
        const urlInput = document.getElementById('urlInput');
        const messageInput = document.getElementById('messageInput');
        const imageInput = document.getElementById('imageInput');
        const agreeCheckbox = document.getElementById('agreeCheckbox');
        const sendButton = document.getElementById('sendButton');
        const statusMessage = document.getElementById('statusMessage');

        // State variable to manage the cooldown period
        let canSend = true;
        const cooldownTime = 4000; // 4 seconds in milliseconds

        sendButton.addEventListener('click', async () => {
            const webhookUrl = urlInput.value.trim();
            const message = messageInput.value.trim();
            const imageFile = imageInput.files[0];

            if (!agreeCheckbox.checked) {
                statusMessage.textContent = 'You must agree to the warning before sending.';
                statusMessage.className = 'mt-4 text-center text-sm font-medium text-red-600';
                return;
            }

            if (webhookUrl === '') {
                statusMessage.textContent = 'Please enter a URL.';
                statusMessage.className = 'mt-4 text-center text-sm font-medium text-red-600';
                return;
            }
            
            // Allow sending if either a message or an image is present
            if (message === '' && !imageFile) {
                statusMessage.textContent = 'Please enter a message or select an image.';
                statusMessage.className = 'mt-4 text-center text-sm font-medium text-red-600';
                return;
            }

            if (!canSend) {
                statusMessage.textContent = 'Please wait before sending another message.';
                statusMessage.className = 'mt-4 text-center text-sm font-medium text-yellow-600';
                return;
            }

            // Start cooldown and disable the button
            canSend = false;
            sendButton.disabled = true;

            statusMessage.textContent = 'Sending...';
            statusMessage.className = 'mt-4 text-center text-sm font-medium text-blue-600';

            // Use FormData to prepare the message and image for sending
            const formData = new FormData();
            formData.append('content', message);

            // Add the image to the form data if it exists
            if (imageFile) {
                formData.append('file', imageFile);
            }

            try {
                // The 'Content-Type' header is not needed here; the browser sets it automatically for FormData
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    body: formData,
                });

                if (response.ok) {
                    statusMessage.textContent = 'Message sent successfully!';
                    statusMessage.className = 'mt-4 text-center text-sm font-medium text-green-600';
                    messageInput.value = '';
                    imageInput.value = ''; // Clear the image input
                } else {
                    const errorText = await response.text();
                    statusMessage.textContent = `Error: ${response.status} - ${errorText || 'Failed to send message.'}`;
                    statusMessage.className = 'mt-4 text-center text-sm font-medium text-red-600';
                }
            } catch (error) {
                if (error instanceof TypeError && error.message === 'Failed to fetch') {
                    statusMessage.textContent = 'Connection failed. Check your URL and network connection.';
                    statusMessage.className = 'mt-4 text-center text-sm font-medium text-red-600';
                } else {
                    statusMessage.textContent = `Error: ${error.message}`;
                    statusMessage.className = 'mt-4 text-center text-sm font-medium text-red-600';
                }
                console.error('Network or other error:', error);
            } finally {
                // Set a timer to re-enable sending after the cooldown period
                setTimeout(() => {
                    canSend = true;
                    sendButton.disabled = false;
                    // Optionally clear the status message after cooldown if no new message is sent
                    if (statusMessage.textContent.includes('wait')) {
                         statusMessage.textContent = '';
                    }
                }, cooldownTime);
            }
        });

    </script>
</body>
</html>


